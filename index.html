<!DOCTYPE html>
<html >
<head>
  <!-- Site made with Mobirise Website Builder v4.9.4, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v4.9.4, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/logo4.png" type="image/x-icon">
  <meta name="description" content="The template page for Lasso & oRIOn code generator.

The blockly_inject.py script must be run to add blockly to this page.">
  <title>Code generator</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/datatables/data-tables.bootstrap4.min.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  
  
  

  <script src="blockly/blockly_compressed.js"></script>
  <script src="blockly/blocks_compressed.js"></script>
  <script src="blockly/msg/js/en.js"></script>
  <script src="blockly/blocks/oRIOn.js"></script>
  <script src="blockly/javascript_compressed.js"></script>
  <script src="blockly/generators/oRIOn/oRIOn.js"></script>  
  <script src="blockly/FileSaver.js"></script>  
</head>
<body>
  <section class="header12 cid-rjuVfqoQgi mbr-fullscreen mbr-parallax-background" id="header12-3">

    

    <div class="mbr-overlay" style="opacity: 0.5; background-color: rgb(35, 35, 35);">
    </div>

    <div class="container  ">
            <div class="media-container">
                <div class="col-md-12 align-center">
                    <h1 class="mbr-section-title pb-3 mbr-white mbr-bold mbr-fonts-style display-1">&nbsp;Lasso &amp; oRIOn Code Generator</h1>
                    <p class="mbr-text pb-3 mbr-white mbr-fonts-style display-5">Develop more efficiently with the official code generator for Lasso &amp; oRIOn.<br>Lasso &amp; oRIOn are tools for real-world interaction with embedded hosts.<br>Lasso is a light-weight asynchronous state observer.<br>oRIOn is an open reconfigurable-I/O network library.</p>
                    <div class="mbr-section-btn align-center py-2">
                        <a class="btn btn-md btn-secondary display-4" href="https://mobirise.co">MORE</a>
                    </div>

                    <div class="icons-media-container mbr-white">
                        <div class="card col-12 col-md-6">
                            <div class="icon-block">
                            <a href="https://github.com/sleven79/lasso-host">
                                <span class="mbr-iconfont mbri-download"></span>
                            </a>
                            </div>
                            <h5 class="mbr-fonts-style display-5">
                                Lasso on Github</h5>
                        </div>

                        <div class="card col-12 col-md-6">
                            <div class="icon-block">
                                <a href="https://github.com/sleven79/lasso-host">
                                    <span class="mbri-sun mbr-iconfont"></span>
                                </a>
                            </div>
                            <h5 class="mbr-fonts-style display-5">Idea behind Lasso</h5>
                        </div>

                        

                        
                    </div>
                </div>
            </div>
    </div>

    <div class="mbr-arrow hidden-sm-down" aria-hidden="true">
        <a href="#next">
            <i class="mbri-down mbr-iconfont"></i>
        </a>
    </div>
</section>

<section class="engine"><a href="https://mobirise.info/u">bootstrap html templates</a></section><section class="section-table cid-rjuXdg1LX9 mbr-parallax-background" id="table1-4">

  
  <div class="mbr-overlay" style="opacity: 0.9; background-color: rgb(255, 255, 255);">
  </div>
  <div class="container container-table">
      <h2 class="mbr-section-title mbr-fonts-style align-center pb-3 display-2">
          Lasso/oRIOn Code Creator</h2>
      <h3 class="mbr-section-subtitle mbr-fonts-style align-center pb-5 mbr-light display-5">Assemble graphical blocks to lasso/oRIOn code.</h3>
      <div class="table-wrapper">
        <div class="container">
          
        </div>

        <div class="container scroll">
          <table class="table" cellspacing="0">
            <thead>
              <tr class="table-heads ">
                  
                  
                  
                  
              <th class="head-item mbr-fonts-style display-7">Block workspace:</th></tr>
            </thead>

            <tbody>
              
              
              
              
            <tr> 
                
                
                
                
              <td class="body-item mbr-fonts-style display-7" style="height: 500px"><div id="blocklyArea" style="height: 95%"></div></td></tr><tr> 
                
                
                
                
              <td class="body-item mbr-fonts-style display-7"><strong>Generated code:</strong></td></tr><tr> 
                
                
                
                
              <td class="body-item mbr-fonts-style display-7" style="height: 100%"><div id="generatorArea"><pre style="font-size: 80%"><code id="generatorCode"></code></pre></div></td></tr><tr> 
                
                
                
                
              <td class="body-item mbr-fonts-style display-7"><strong>Workspace operations:</strong></td></tr><tr> 
                
                
                
                
              <td class="body-item mbr-fonts-style display-7"><p><button onclick="saveWorkspaceEvent()">Save workspace by clicking here!</button>&nbsp;<input type="text" id="filename" value="workspace.txt"></p>
<p><button onclick="loadWorkspaceEvent(loadWorkspace)">Load workspace by clicking here!</button></p>
</td></tr></tbody>
          </table>
        </div>
        <div class="container table-info-container">
          
        </div>
      </div>
    </div>
</section>


  <script src="assets/web/assets/jquery/jquery.min.js"></script>
  <script src="assets/popper/popper.min.js"></script>
  <script src="assets/tether/tether.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/smoothscroll/smooth-scroll.js"></script>
  <script src="assets/vimeoplayer/jquery.mb.vimeo_player.js"></script>
  <script src="assets/parallax/jarallax.min.js"></script>
  <script src="assets/datatables/jquery.data-tables.min.js"></script>
  <script src="assets/datatables/data-tables.bootstrap4.min.js"></script>
  <script src="assets/theme/js/script.js"></script>
  
  
<div id="blocklyDiv" style="position: absolute"></div>

  <xml xmlns="http://www.w3.org/1999/xhtml" id="toolbox" style="display: none;">
    <category name="oRIOn">
      <category name="Pins" colour="#A65C94">
        <block type="orion_pin_container"></block>
        <block type="orion_config_pin">
          <field name="PORT_ID">0</field>
          <field name="PIN_ID">0</field>
          <field name="TYPE">0</field>          
        </block>
        <block type="orion_input_pin"></block>
      </category>  
      <category name="Counters" colour="#74A65C">  
        <block type="orion_counter_container"></block>      
        <block type="orion_configure_counter_mutable"></block>
        <block type="orion_counter"></block>    
      </category>
      <category name="Inputs" colour="#5CA681">
        <block type="orion_input_container"></block>      
        <block type="orion_configure_input_from_pin_mutable"></block>    
        <block type="orion_configure_input_mutable"></block>    
        <block type="orion_input"></block>
        <block type="orion_group_input"></block>
      </category>
      <category name="Transformers" colour="#A65C5C">
        <block type="orion_transformer_container"></block>      
        <block type="orion_transformer_mutable"></block>
        <block type="orion_configure_transformer_mutable"></block>    
        <block type="orion_transformer"></block>
        <block type="orion_group_transformer"></block>
      </category>  
      <category name="Outputs" colour="#815CA6">
        <block type="orion_output_container"></block>      
        <block type="orion_configure_output_to_pin_mutable"></block>     
        <block type="orion_group_output"></block>
      </category>
      <category name="Numerics" colour="#A6A65C">
        <block type="orion_constant">
          <field name="CONST">0</field>
        </block>
        <block type="orion_time_constant"></block>
        <block type="orion_defaults"></block>
        <block type="orion_PID_parameters">
          <value name="KP">
            <shadow type="orion_constant">
                <field name="CONST">1</field>
            </shadow>
          </value>
          <value name="KI">
            <shadow type="orion_constant">
                <field name="CONST">0</field>
            </shadow>
          </value>        
          <value name="KD">
            <shadow type="orion_constant">
                <field name="CONST">0</field>
            </shadow>
          </value>                
        </block>
        <block type="orion_range"></block>
      </category>  
      <category name="Groups" colour="#5C68A6">
        <block type="orion_group"></block>      
      </category>
    </category>
    <sep gap="32"></sep>
    <category name="lasso">
      <block type="lasso_register_datacell"></block> 
      <block type="lasso_register_orion_wire"></block> 
    </category>  
    <sep gap="32"></sep>  
    <category name="Code generator">
      <button text="Generate C-code" callbackKey="generateCcodePressed"></button>
      <button text="Save workspace" callbackKey="generateCcodePressed"></button>
    </category>
  </xml>

  <xml xmlns="http://www.w3.org/1999/xhtml" id="startBlocks" style="display: none;">
    <block type="orion_init" x="10" y="10">
      <statement name="STATEMENTS">
        <block type="orion_pin_container">
          <next>
            <block type="orion_counter_container">
              <next>                
                <block type="orion_input_container">
                  <next>
                    <block type="orion_transformer_container">
                      <next>
                        <block type="orion_output_container"></block>                            
                      </next>
                    </block>                
                  </next>
                </block>
              </next>
            </block>
          </next>                        
        </block>         
      </statement>
    </block>
    
    <block type="lasso_init" x="10" y="400">
    </block>
  </xml>  


  <script>
    var blocklyArea = document.getElementById('blocklyArea');
    var blocklyDiv = document.getElementById('blocklyDiv');
    var demoWorkspace = Blockly.inject(blocklyDiv,
        {media: 'blockly/media/',
         toolbox: document.getElementById('toolbox')});
    var onresize = function(e) {
      // Compute the absolute coordinates and dimensions of blocklyArea.
      var element = blocklyArea;
      var x = 0;
      var y = 0;
      do {
        x += element.offsetLeft;
        y += element.offsetTop;
        element = element.offsetParent;
      } while (element);
      // Position blocklyDiv over blocklyArea.
      blocklyDiv.style.left = x + 'px';
      blocklyDiv.style.top = y + 'px';
      blocklyDiv.style.width = blocklyArea.offsetWidth + 'px';
      blocklyDiv.style.height = blocklyArea.offsetHeight + 'px';
      Blockly.svgResize(demoWorkspace);
    };
    window.addEventListener('resize', onresize, false);
    onresize();
    Blockly.svgResize(demoWorkspace);
    
    // place default start blocks
    Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'),
                               demoWorkspace);   
    /*
    var blocks = demoWorkspace.getAllBlocks();
    for (var i = 0; i < blocks.length; i++) {
        if (blocks[i].type == "orion_init") {
            blocks[i].setDeletable(false);
            blocks[i].setMovable(false);
        }
    }
    */

    // generator function
    Blockly.JavaScript.INDENT = "";
    function myUpdateFunction(event) {
        var code = Blockly.JavaScript.workspaceToCode(demoWorkspace);
        document.getElementById('generatorCode').innerHTML = code;
    }
    demoWorkspace.addChangeListener(myUpdateFunction); 
    
    // save and load events
    function saveWorkspaceEvent() {  
        try {
            var isFileSaverSupported = !!new Blob;
        } catch (e) {
            alert("Javascript 'Blob' not supported!" + e);
            return;
        }
        
        var name = document.getElementById('filename').value;
        
        var xml = Blockly.Xml.workspaceToDom(demoWorkspace);
        var xml_text = Blockly.Xml.domToPrettyText(xml);
        var blob = new Blob([xml_text], {type: "text/plain;charset=utf-8"});
        saveAs(blob, name);  // from FileSaver.js
    }
    
    function loadWorkspace(xml_text) {
        demoWorkspace.clear();
        //console.log(xml_text);
        var xml = Blockly.Xml.textToDom(xml_text);
        Blockly.Xml.domToWorkspace(xml, demoWorkspace);    
    }
    
    function loadWorkspaceEvent(func) {
        readFile = function(e) {
            var file = e.target.files[0];
            if (!file) {
                return;
            }
            var reader = new FileReader();
            reader.onload = function(e) {
                var contents = e.target.result;
                fileInput.func(contents)
                document.body.removeChild(fileInput)
            }
            reader.readAsText(file)
        }
        fileInput = document.createElement("input")
        fileInput.type='file'
        fileInput.style.display='none'
        fileInput.onchange=readFile
        fileInput.func=func
        document.body.appendChild(fileInput)
        fileInput.click();
    }
    
    // delete event
    function deleteEvent(event) {
      if (Blockly.Events.BLOCK_DELETE == event.type) {
        Blockly.Constants.oRIOn.CLEAN_IDS_ON_DELETE(event);
      }
    }
    demoWorkspace.addChangeListener(deleteEvent);    
  </script>

</body>
</html>